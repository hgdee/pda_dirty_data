---
title: "D12 weekend homework week 2"
output:
  html_document: 
    number_sections: yes
    toc: yes
    df_print: paged
    toc_float: yes
---

```{r}
library(tidyverse)
library(here)
library(janitor)
library(stringr)
library(assertr)
library(testthat)
library(readxl)
```

1 MVP
1.1 Task 1 - Decathlon Data
This data is contained in the .rds file decathlon.rds. Youâ€™ll need to use read_rds() from readr to open it.

# Call R file to process the rds file.

```{r}
source(here::here("R_scripts/read_rds_data.R"))
```

```{r}
decathlon_data  
```


# 1.1.2 Analysis questions
  ## 1 Who had the longest long jump seen in the data?
```{r}
decathlon_data %>% 
  filter(long_jump == max(long_jump))
```

  ## 2 What was the average 100m time in each competition?
```{r}
decathlon_data %>% 
  group_by(competition) %>%
   summarise(mean(x100m))
```
  
## 3 Who had the highest total points across both competitions?
```{r}
decathlon_data %>% 
  filter(points== max(points))
```
  ## 4 What was the shot-put scores for the top three competitors in each competition?
```{r}
rbind(decathlon_data %>% 
  filter(competition == "olympicg") %>%
  select(competition,competitor,shot_put) %>%
  group_by(competition, competitor) %>%
  arrange(desc(shot_put)) %>%
  head(3), 
  decathlon_data %>% 
  filter(competition == "decastar") %>%
  select(competition,competitor,shot_put) %>%
  group_by(competition, competitor) %>%
  arrange(desc(shot_put)) %>%
  head(3))



```
  
## 5 What was the average points for competitors who ran the 400m in less than 50 seconds vs. those than ran 400m in more than 50 seconds?

```{r}
rbind(decathlon_data  %>%
    filter(x400m < 50) %>%
    summarise(round(mean(points),2 )) %>%
    distinct() %>%
    paste( " average points where 400m < 50 secs"),
  decathlon_data  %>%
    filter(x400m >= 50) %>%
    summarise( round(mean(points),2)) %>%
    distinct() %>%
    paste( " average points where 400m >= 50 secs")
)

```

# 1.4 Task 4 - Halloween Candy Data
The data is in files boing-boing-candy-2015.xlxs, boing-boing-candy-2016.xlxs and boing-boing-candy-2017.xlxs. Bear in mind that this is trickier compared with tasks 1, 2 & 3.

```{r}

source(here::here("R_scripts/read_in_candy_data.R"))


```

## Output to show valid which_country_do_you_live_in data
    2015 was populated using 2016 residence data and looping to populate
    the larger data set.

```{r}
candy_data_3 %>%
  group_by(which_country_do_you_live_in)  %>%
  count() %>%
  arrange(desc(n))

```


```{r}

drop_cols_list <- c("please","which", "sourpatch", "spotted_dick", "those",
                   "vials", "white", "whole", "guess", "betty", "that",
                  "what", "do", "when", "york", "cash", "glow", "broken",
                 "fuzzy", "dental", "candy_that_is", "creepy", "hugs",
                "peterson", "generic", "sourpatch", "person")

hit_list <-candy_data_1 %>% 
                select(starts_with(drop_cols_list))
  
`%ni%` <- Negate(`%in%`)
candy_data_1 <- subset(candy_data_1,select = names(candy_data_1) %ni% (names(hit_list)))

candy_data_2 <- subset(candy_data_2,select = names(candy_data_2) %ni% (names(hit_list)))

names(candy_data_2)

candy_data_3 <- subset(candy_data_3,select = names(candy_data_3) %ni% (names(hit_list)))
names(candy_data_3)
```

# Now the three years of data need to be merged. 
```{r}


  
  candy_data_1 <- candy_data_1[, -grep("^please", names(candy_data_1))]
  candy_data_1 <- candy_data_1[, -grep("^which", names(candy_data_1))]
  candy_data_1 <- candy_data_1[, -grep("^sourpatch", names(candy_data_1))]
  candy_data_1 <- candy_data_1[, -grep("^spotted_dick", names(candy_data_1))]
  candy_data_1 <- candy_data_1[, -grep("^those", names(candy_data_1))]
  candy_data_1 <- candy_data_1[, -grep("^vials", names(candy_data_1))]
  candy_data_1 <- candy_data_1[, -grep("^white", names(candy_data_1))]
  candy_data_1 <- candy_data_1[, -grep("^whole", names(candy_data_1))]
  candy_data_1 <- candy_data_1[, -grep("^guess", names(candy_data_1))]
  candy_data_1 <- candy_data_1[, -grep("^betty", names(candy_data_1))]
  candy_data_1 <- candy_data_1[, -grep("^that", names(candy_data_1))]
  candy_data_1 <- candy_data_1[, -grep("^what", names(candy_data_1))]
  candy_data_1 <- candy_data_1[, -grep("^do", names(candy_data_1))]
  candy_data_1 <- candy_data_1[, -grep("^when", names(candy_data_1))]
  candy_data_1 <- candy_data_1[, -grep("^cash", names(candy_data_1))]
  candy_data_1 <- candy_data_1[, -grep("^york", names(candy_data_1))]
  candy_data_1 <- candy_data_1[, -grep("^glow", names(candy_data_1))]
  candy_data_1 <- candy_data_1[, -grep("^broken", names(candy_data_1))]
  candy_data_1 <- candy_data_1[, -grep("^fuzzy", names(candy_data_1))]
  candy_data_1 <- candy_data_1[, -grep("^dental", names(candy_data_1))]
  candy_data_1 <- candy_data_1[, -grep("^candy_that_is", names(candy_data_1))]
  candy_data_1 <- candy_data_1[, -grep("^creepy", names(candy_data_1))]
  candy_data_1 <- candy_data_1[, -grep("^hugs", names(candy_data_1))]
  candy_data_1 <- candy_data_1[, -grep("^generic", names(candy_data_1))]
  candy_data_1 <- candy_data_1[, -grep("^person", names(candy_data_1))]
  candy_data_1 <- candy_data_1[, -grep("the_board_game", names(candy_data_1))]
 
   
names(candy_data_1)


```

```{r}
  candy_data_2 <- candy_data_2[, -grep("^please", names(candy_data_2))]
  candy_data_2 <- candy_data_2[, -grep("^which", names(candy_data_2))]
  candy_data_2 <- candy_data_2[, -grep("^sourpatch", names(candy_data_2))]
  candy_data_2 <- candy_data_2[, -grep("^spotted_dick", names(candy_data_2))]
  candy_data_2 <- candy_data_2[, -grep("^those", names(candy_data_2))]
  candy_data_2 <- candy_data_2[, -grep("^vials", names(candy_data_2))]
  candy_data_2 <- candy_data_2[, -grep("^white", names(candy_data_2))]
  candy_data_2 <- candy_data_2[, -grep("^whole", names(candy_data_2))]
  candy_data_2 <- candy_data_2[, -grep("^guess", names(candy_data_2))]
  candy_data_2 <- candy_data_2[, -grep("^betty", names(candy_data_2))]
  candy_data_2 <- candy_data_2[, -grep("^that", names(candy_data_2))]
  candy_data_2 <- candy_data_2[, -grep("^what", names(candy_data_2))]
  candy_data_2 <- candy_data_2[, -grep("^do", names(candy_data_2))]
  candy_data_2 <- candy_data_2[, -grep("^when", names(candy_data_2))]
  candy_data_2 <- candy_data_2[, -grep("^cash", names(candy_data_2))]
  candy_data_2 <- candy_data_2[, -grep("^york", names(candy_data_2))]
  candy_data_2 <- candy_data_2[, -grep("^glow", names(candy_data_2))]
  candy_data_2 <- candy_data_2[, -grep("^broken", names(candy_data_2))]
  candy_data_2 <- candy_data_2[, -grep("^fuzzy", names(candy_data_2))]
  candy_data_2 <- candy_data_2[, -grep("^dental", names(candy_data_2))]
  candy_data_2 <- candy_data_2[, -grep("^candy_that_is", names(candy_data_2))]
  candy_data_2 <- candy_data_2[, -grep("^creepy", names(candy_data_2))]
  candy_data_2 <- candy_data_2[, -grep("^hugs", names(candy_data_2))]
  candy_data_2 <- candy_data_2[, -grep("^generic", names(candy_data_2))]
  candy_data_2 <- candy_data_2[, -grep("^person", names(candy_data_2))]
  candy_data_2 <- candy_data_2[, -grep("the_board_game", names(candy_data_2))]
  names(candy_data_2)
```

```{r}


candy_data_1 <- candy_data_1[, -grep("^please", names(candy_data_1))]
candy_data_1 <- candy_data_1[, -grep("^which", names(candy_data_1))]
candy_data_1 <- candy_data_1[, -grep("^sourpatch", names(candy_data_1))]
candy_data_1 <- candy_data_1[, -grep("^spotted_dick", names(candy_data_1))]
candy_data_1 <- candy_data_1[, -grep("^those", names(candy_data_1))]
candy_data_1 <- candy_data_1[, -grep("^vials", names(candy_data_1))]
candy_data_1 <- candy_data_1[, -grep("^white", names(candy_data_1))]
candy_data_1 <- candy_data_1[, -grep("^whole", names(candy_data_1))]
candy_data_1 <- candy_data_1[, -grep("^guess", names(candy_data_1))]
candy_data_1 <- candy_data_1[, -grep("^betty", names(candy_data_1))]
candy_data_1 <- candy_data_1[, -grep("^that", names(candy_data_1))]
candy_data_1 <- candy_data_1[, -grep("^what", names(candy_data_1))]
candy_data_1 <- candy_data_1[, -grep("^do", names(candy_data_1))]
candy_data_1 <- candy_data_1[, -grep("^when", names(candy_data_1))]
candy_data_1 <- candy_data_1[, -grep("^cash", names(candy_data_1))]
candy_data_1 <- candy_data_1[, -grep("^york", names(candy_data_1))]
candy_data_1 <- candy_data_1[, -grep("^glow", names(candy_data_1))]
candy_data_1 <- candy_data_1[, -grep("^broken", names(candy_data_1))]
candy_data_1 <- candy_data_1[, -grep("^fuzzy", names(candy_data_1))]
candy_data_1 <- candy_data_1[, -grep("^dental", names(candy_data_1))]
candy_data_1 <- candy_data_1[, -grep("^candy_that_is", names(candy_data_1))]
candy_data_1 <- candy_data_1[, -grep("^creepy", names(candy_data_1))]
candy_data_1 <- candy_data_1[, -grep("^hugs", names(candy_data_1))]
candy_data_1 <- candy_data_1[, -grep("^generic", names(candy_data_1))]
candy_data_1 <- candy_data_1[, -grep("^person", names(candy_data_1))]
candy_data_1 <- candy_data_1[, -grep("the_board_game", names(candy_data_1))]
candy_data_2 <- candy_data_2[, -grep("^please", names(candy_data_2))]
candy_data_2 <- candy_data_2[, -grep("^which", names(candy_data_2))]
candy_data_2 <- candy_data_2[, -grep("^sourpatch", names(candy_data_2))]
candy_data_2 <- candy_data_2[, -grep("^spotted_dick", names(candy_data_2))]
candy_data_2 <- candy_data_2[, -grep("^those", names(candy_data_2))]
candy_data_2 <- candy_data_2[, -grep("^vials", names(candy_data_2))]
candy_data_2 <- candy_data_2[, -grep("^white", names(candy_data_2))]
candy_data_2 <- candy_data_2[, -grep("^whole", names(candy_data_2))]
candy_data_2 <- candy_data_2[, -grep("^guess", names(candy_data_2))]
candy_data_2 <- candy_data_2[, -grep("^betty", names(candy_data_2))]
candy_data_2 <- candy_data_2[, -grep("^that", names(candy_data_2))]
candy_data_2 <- candy_data_2[, -grep("^what", names(candy_data_2))]
candy_data_2 <- candy_data_2[, -grep("^do", names(candy_data_2))]
candy_data_2 <- candy_data_2[, -grep("^when", names(candy_data_2))]
candy_data_2 <- candy_data_2[, -grep("^cash", names(candy_data_2))]
candy_data_2 <- candy_data_2[, -grep("^york", names(candy_data_2))]
candy_data_2 <- candy_data_2[, -grep("^glow", names(candy_data_2))]
candy_data_2 <- candy_data_2[, -grep("^broken", names(candy_data_2))]
candy_data_2 <- candy_data_2[, -grep("^fuzzy", names(candy_data_2))]
candy_data_2 <- candy_data_2[, -grep("^dental", names(candy_data_2))]
candy_data_2 <- candy_data_2[, -grep("^candy_that_is", names(candy_data_2))]
candy_data_2 <- candy_data_2[, -grep("^creepy", names(candy_data_2))]
candy_data_2 <- candy_data_2[, -grep("^hugs", names(candy_data_2))]
candy_data_2 <- candy_data_2[, -grep("^generic", names(candy_data_2))]
candy_data_2 <- candy_data_2[, -grep("^person", names(candy_data_2))]
candy_data_2 <- candy_data_2[, -grep("the_board_game", names(candy_data_2))]
  candy_data_3 <- candy_data_3[, -grep("^please", names(candy_data_3))]
  candy_data_3 <- candy_data_3[, -grep("^which", names(candy_data_3))]
  candy_data_3 <- candy_data_3[, -grep("^sourpatch", names(candy_data_3))]
  candy_data_3 <- candy_data_3[, -grep("^spotted_dick", names(candy_data_3))]
  candy_data_3 <- candy_data_3[, -grep("^those", names(candy_data_3))]
  candy_data_3 <- candy_data_3[, -grep("^vials", names(candy_data_3))]
  candy_data_3 <- candy_data_3[, -grep("^white", names(candy_data_3))]
  candy_data_3 <- candy_data_3[, -grep("^whole", names(candy_data_3))]
  candy_data_3 <- candy_data_3[, -grep("^guess", names(candy_data_3))]
  candy_data_3 <- candy_data_3[, -grep("^betty", names(candy_data_3))]
  candy_data_3 <- candy_data_3[, -grep("^that", names(candy_data_3))]
  candy_data_3 <- candy_data_3[, -grep("^what", names(candy_data_3))]
  candy_data_3 <- candy_data_3[, -grep("^do", names(candy_data_3))]
  candy_data_3 <- candy_data_3[, -grep("^when", names(candy_data_3))]
  candy_data_3 <- candy_data_3[, -grep("^cash", names(candy_data_3))]
  candy_data_3 <- candy_data_3[, -grep("^york", names(candy_data_3))]
  candy_data_3 <- candy_data_3[, -grep("^glow", names(candy_data_3))]
  candy_data_3 <- candy_data_3[, -grep("^broken", names(candy_data_3))]
  candy_data_3 <- candy_data_3[, -grep("^fuzzy", names(candy_data_3))]
  candy_data_3 <- candy_data_3[, -grep("^dental", names(candy_data_3))]
  candy_data_3 <- candy_data_3[, -grep("^candy_that_is", names(candy_data_3))]
  candy_data_3 <- candy_data_3[, -grep("^creepy", names(candy_data_3))]
  candy_data_3 <- candy_data_3[, -grep("^hugs", names(candy_data_3))]
  candy_data_3 <- candy_data_3[, -grep("^generic", names(candy_data_3))]
  candy_data_3 <- candy_data_3[, -grep("^person", names(candy_data_3))]
  candy_data_3 <- candy_data_3[, -grep("the_board_game", names(candy_data_3))]
  names(candy_data_3)
```







